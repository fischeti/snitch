#pragma once

//#define BANSHEE

struct layer_config {
    uint32_t n;
    uint32_t co;
    uint32_t ci;
    uint32_t fh;
    uint32_t fw;
    uint32_t ih;
    uint32_t iw;
    uint32_t oh;
    uint32_t ow;
};

struct layer_config l = {
    .n = 1,
    .co = 16,
    .ci = 1,
    .fh = 3,
    .fw = 3,
    .ih = 8,
    .iw = 8,
    .oh = 6,
    .ow = 6,
};

double* ofmap_addr = (void*)0x80040000;

static double ifmap_dram[64] = {0.3745401188473625, 0.9507143064099162, 0.7319939418114051, 0.5986584841970366, 0.15601864044243652, 0.15599452033620265, 0.05808361216819946, 0.8661761457749352, 0.6011150117432088, 0.7080725777960455, 0.020584494295802447, 0.9699098521619943, 0.8324426408004217, 0.21233911067827616, 0.18182496720710062, 0.18340450985343382, 0.3042422429595377, 0.5247564316322378, 0.43194501864211576, 0.2912291401980419, 0.6118528947223795, 0.13949386065204183, 0.29214464853521815, 0.3663618432936917, 0.45606998421703593, 0.7851759613930136, 0.19967378215835974, 0.5142344384136116, 0.5924145688620425, 0.046450412719997725, 0.6075448519014384, 0.17052412368729153, 0.06505159298527952, 0.9488855372533332, 0.9656320330745594, 0.8083973481164611, 0.3046137691733707, 0.09767211400638387, 0.6842330265121569, 0.4401524937396013, 0.12203823484477883, 0.4951769101112702, 0.034388521115218396, 0.9093204020787821, 0.2587799816000169, 0.662522284353982, 0.31171107608941095, 0.5200680211778108, 0.5467102793432796, 0.18485445552552704, 0.9695846277645586, 0.7751328233611146, 0.9394989415641891, 0.8948273504276488, 0.5978999788110851, 0.9218742350231168, 0.0884925020519195, 0.1959828624191452, 0.045227288910538066, 0.32533033076326434, 0.388677289689482, 0.2713490317738959, 0.8287375091519293, 0.3567533266935893};
static double weights_dram[144] = {0.28093450968738076, 0.5426960831582485, 0.14092422497476265, 0.8021969807540397, 0.07455064367977082, 0.9868869366005173, 0.7722447692966574, 0.1987156815341724, 0.005522117123602399, 0.8154614284548342, 0.7068573438476171, 0.7290071680409873, 0.7712703466859457, 0.07404465173409036, 0.3584657285442726, 0.11586905952512971, 0.8631034258755935, 0.6232981268275579, 0.3308980248526492, 0.06355835028602363, 0.3109823217156622, 0.32518332202674705, 0.7296061783380641, 0.6375574713552131, 0.8872127425763265, 0.4722149251619493, 0.1195942459383017, 0.713244787222995, 0.7607850486168974, 0.5612771975694962, 0.770967179954561, 0.49379559636439074, 0.5227328293819941, 0.42754101835854963, 0.02541912674409519, 0.10789142699330445, 0.03142918568673425, 0.6364104112637804, 0.3143559810763267, 0.5085706911647028, 0.907566473926093, 0.24929222914887494, 0.41038292303562973, 0.7555511385430487, 0.22879816549162246, 0.07697990982879299, 0.289751452913768, 0.16122128725400442, 0.9296976523425731, 0.808120379564417, 0.6334037565104235, 0.8714605901877177, 0.8036720768991145, 0.18657005888603584, 0.8925589984899778, 0.5393422419156507, 0.8074401551640625, 0.8960912999234932, 0.3180034749718639, 0.11005192452767676, 0.22793516254194168, 0.4271077886262563, 0.8180147659224931, 0.8607305832563434, 0.006952130531190703, 0.5107473025775657, 0.417411003148779, 0.22210781047073025, 0.1198653673336828, 0.33761517140362796, 0.9429097039125192, 0.32320293202075523, 0.5187906217433661, 0.7030189588951778, 0.363629602379294, 0.9717820827209607, 0.9624472949421112, 0.25178229582536416, 0.49724850589238545, 0.30087830981676966, 0.2848404943774676, 0.036886947354532795, 0.6095643339798968, 0.5026790232288615, 0.05147875124998935, 0.27864646423661144, 0.9082658859666537, 0.23956189066697242, 0.1448948720912231, 0.489452760277563, 0.9856504541106007, 0.2420552715115004, 0.6721355474058786, 0.7616196153287176, 0.23763754399239967, 0.7282163486118596, 0.3677831327192532, 0.6323058305935795, 0.6335297107608947, 0.5357746840747585, 0.0902897700544083, 0.835302495589238, 0.32078006497173583, 0.18651851039985423, 0.040775141554763916, 0.5908929431882418, 0.6775643618422824, 0.016587828927856152, 0.512093058299281, 0.22649577519793795, 0.6451727904094499, 0.17436642900499144, 0.690937738102466, 0.3867353463005374, 0.9367299887367345, 0.13752094414599325, 0.3410663510502585, 0.11347352124058907, 0.9246936182785628, 0.877339353380981, 0.2579416277151556, 0.659984046034179, 0.8172222002012158, 0.5552008115994623, 0.5296505783560065, 0.24185229090045168, 0.09310276780589921, 0.8972157579533268, 0.9004180571633305, 0.6331014572732679, 0.3390297910487007, 0.3492095746126609, 0.7259556788702394, 0.8971102599525771, 0.8870864242651173, 0.7798755458576239, 0.6420316461542878, 0.08413996499504883, 0.16162871409461377, 0.8985541885270792, 0.6064290596595899, 0.009197051616629648, 0.1014715428660321, 0.6635017691080558};
static double ofmap_dram[576] = {1.6212524000036042, 2.768126679361315, 1.8576835719799734, 1.671765770433089, 1.5015607709128356, 0.7301038918373818, 1.7748341123063138, 1.736212983052429, 1.8811613085472205, 1.6861634915841646, 1.634335061847404, 0.8369554942838838, 1.2967022290991268, 2.5042433308591567, 2.0568101128288037, 1.6213995693818268, 1.6254615728729747, 0.7140321102652647, 1.8511031504336959, 2.4266443689191513, 1.7628484215843438, 1.9974077423993002, 1.5373747007491385, 1.5069788731461247, 1.3023464833889487, 2.5414366503539774, 2.0116599955862275, 2.5989914441799757, 1.7062564181009219, 2.343686713833893, 1.8246147443883627, 1.4335919968959834, 2.404098752694182, 2.3941760271133496, 2.2452606628490117, 2.476968245859349, 2.791903104397686, 3.2395702991673025, 2.2026893784970727, 2.2467869135156917, 1.3761610050114657, 1.539357938494265, 2.28903332159233, 2.4239734584802157, 2.7194934632521295, 2.453914963968527, 2.0358422394563602, 1.3319728378582816, 2.8437847717913742, 3.197512746357706, 2.4080587894446563, 1.6462609259338645, 2.0347330516485616, 1.605502460272773, 2.0020203916735735, 2.9032663277965156, 2.822124771388667, 2.2946785383248494, 2.2423741294989563, 1.545376509489226, 2.3980788310865675, 4.097502427351796, 3.134492398987391, 3.362166553646895, 2.4304924545985727, 2.79900300381868, 1.4651152649776475, 1.8477523723650056, 2.529735255765813, 2.9378822731171033, 2.7075534378665984, 3.173706183440405, 1.7065916486791126, 2.1153020659307322, 2.1677840709929175, 1.878645859760354, 1.26480183429695, 0.9488466808726993, 1.8067856653709402, 2.0611065979393017, 1.561199138648378, 1.811471059338222, 1.4526840435127983, 0.9794398443494208, 1.7381087218596745, 2.4150539239763127, 2.444421164323664, 1.6804448521194248, 1.3142671206725511, 1.2081515348110854, 1.9382409968537293, 2.525230073423077, 1.871867123773472, 1.7778485895267786, 1.5741968635688486, 1.715809361431293, 1.4933192263770145, 2.1071719659856947, 2.6438668915614945, 2.4625008127559416, 2.413645019704088, 2.1736190286667205, 1.1898336333863373, 1.9446826819071126, 1.8697046467693503, 2.536029248662071, 2.136338535623597, 2.3904855575922754, 2.4151408357650874, 2.9008200903777075, 2.2531539583595728, 2.0581800183811803, 1.4009006652448552, 1.0975714648567583, 1.9349520294198306, 2.2314272517587606, 2.178821040291342, 2.2837771342927824, 1.8706586945385155, 0.8897353492740089, 1.8584898776113676, 2.3565596865177034, 2.0568688359192535, 1.8286756846051808, 1.7102931976117, 1.0589764938723387, 2.126661261885138, 2.942210281879841, 2.2347689943443165, 2.1350981252795966, 1.6007355463622277, 1.5815980212024479, 2.0099123184278946, 2.926547790399557, 2.621129295888079, 2.49014119489003, 1.8541474804623408, 2.2710628815432177, 1.5503730558624405, 2.036246845642676, 2.5524952249767767, 2.924828800876133, 2.6047800549142215, 2.6441740867600556, 2.420550979786609, 1.9128386853934782, 2.0885838627012583, 2.0825618491198044, 1.2071652293648627, 0.9946834978312233, 2.040737663212782, 1.6624894700424098, 2.122122049785175, 2.0344515276750865, 1.1462730047134477, 1.124566857777522, 2.438189819168566, 2.39561659025489, 2.1839505766165863, 1.837404215881864, 1.0500963627058226, 1.5807592004198292, 2.143863225580996, 2.311127670047153, 2.5808320365522293, 1.8399910331817833, 1.3313888132897012, 1.848491871219836, 2.0153879224744555, 2.3939952120452768, 2.7463573161135453, 2.3451214805874763, 2.2958646974537, 2.3562632075812355, 1.2120387921036013, 1.679541708887873, 2.4452203419886387, 2.360738140750289, 2.520864526400949, 2.429353309799687, 2.333872536720537, 2.529852745326011, 2.309807308364141, 2.5969232898518224, 1.8270768530732417, 1.053705077301493, 2.30099692193163, 2.178898790951836, 2.1391117627028726, 2.136568749536231, 1.6884790580449938, 1.256989964813116, 2.429546959473361, 3.183350054714274, 2.740744501798107, 2.1759588429301275, 1.57935665807755, 1.5137533779542969, 2.244460013376194, 3.0045857972535397, 2.8128968498662728, 2.402341054616865, 1.768660728565178, 2.0545519722035825, 1.7769263876447878, 2.632229143779437, 2.931592056063696, 3.237896749577781, 2.7849208660871594, 2.906313198471165, 1.6732770846680345, 1.9088926455729835, 2.804136564416468, 2.944955637845892, 2.9488425721652542, 3.0932409987158693, 2.8510021440279636, 3.0168560866460212, 2.2440439027298544, 2.3434739966250158, 1.5417890269957604, 1.5944890884687286, 2.0247296447335508, 2.7507856186663817, 2.5103935599205416, 2.3652492944830175, 2.2809791744562276, 1.103466381273024, 2.7936959384491287, 3.050165474996227, 2.25884668686893, 1.751135427132473, 2.1405909014019904, 1.5060348098484528, 1.7255243276635983, 3.3414433609207954, 2.6977012837839496, 2.5077658279627246, 2.020634462842584, 1.5699432755625438, 2.6168382342853627, 3.665528872820302, 3.2128970273790265, 3.2446660015066766, 2.4393445473821447, 2.775087935534101, 1.200027110704193, 2.084139532139357, 2.4160067539624848, 3.0401001926074955, 2.9146337987834503, 2.9804580088358943, 1.8506200192044735, 2.224125859781204, 1.6558820385140456, 1.9315675035007849, 1.0139909088396566, 1.1690419544911383, 1.7870173038175654, 2.0744311702825238, 1.511710985090029, 1.9704696912182356, 1.5724134612219742, 1.088388370862702, 2.103600736096575, 2.529288798365438, 2.1415964670359586, 1.2696828350733758, 1.423327649792879, 1.3043894143739188, 1.3728723971565322, 2.140805027109788, 2.0497995072249435, 1.652394487741877, 1.8642055549913132, 1.06248219529453, 1.3930787210373683, 2.7868266649454383, 2.601565389833711, 2.7010367708475305, 2.259045451878926, 1.8855740891934485, 0.7408166884519226, 1.4902698638052547, 1.3052320599927274, 2.3263630993651483, 1.7040555948114091, 2.4431933287161605, 2.8318781570598546, 2.6514781871245754, 2.4971269558383655, 2.6428131274894118, 1.7002556280114773, 1.1258697522712862, 2.2464877989599508, 2.330480066267287, 2.272100835325085, 2.5198033475191957, 1.9312653726326074, 1.0681187767373972, 2.5258821702808456, 2.7591082892273344, 2.2995935549364517, 2.2349892560263274, 1.670849225718688, 1.4635873214144188, 2.300269621943283, 3.305311297747662, 2.838050466848899, 2.522234958235138, 1.5400206448232876, 1.9488597982927585, 2.259446270005557, 2.8127745197449436, 3.1367459206434205, 2.8915809957283374, 2.3498120695489866, 2.6539631416130196, 1.4931082201240844, 2.1234291554750184, 2.9070937181122076, 3.133372713110237, 3.1490890005806307, 2.914992122248205, 1.5685739833009646, 2.036163097777051, 1.9428983101911885, 0.8970459782906017, 0.7069868116687262, 0.9598088249780903, 1.3390967826459046, 1.4068302078569768, 2.0818473855636643, 1.1938871376792357, 1.0332670109547886, 0.8148215491312787, 1.5975501709372162, 1.7550738460932676, 1.6902154698110337, 0.9731666468734003, 1.2717329054486746, 1.0319257788661802, 1.8584289838818617, 2.0300063714493017, 1.4369102137737115, 1.1982478316559262, 1.3304873242426394, 1.5116617896180575, 1.8740261773531204, 2.4551215801832593, 1.9761312314038835, 1.7450604981477198, 1.5431388298258253, 1.9874784137555612, 1.3556567977064002, 1.6927750331890496, 2.053069509953902, 1.9058198678450684, 1.9489002524388355, 1.8855464954398606, 2.4497174935204526, 3.417732683254307, 2.5542621304148407, 2.4061942320362473, 1.545765773060351, 1.556620891461198, 2.239391128063381, 2.810006665200002, 2.4322235695415593, 2.3621382900995056, 2.3381476129662357, 1.3283029336184333, 2.632234331632533, 3.309158365750199, 2.6724506889518365, 1.6469702211536865, 2.3451285276768195, 1.5057999943169715, 2.131786847096627, 3.4886680768784384, 2.620400102913689, 2.3584671746445944, 2.4685596503357425, 1.635213120494876, 2.1107141532346927, 3.931978850679519, 3.224840054792892, 3.618722283714205, 2.6554310856087566, 2.8063139355502917, 1.614761966731654, 2.350027818541445, 2.503330613175408, 3.40678199211359, 2.828086008899078, 3.4227753258421614, 1.7661748281515048, 1.9536205983534674, 1.2607205833335666, 1.5291562838330592, 0.921144723047722, 1.2082974754402624, 1.4210803879183762, 2.0599429104625266, 1.4880099981416508, 1.6914388748410412, 1.2428578115536109, 0.8394833755176924, 1.5694672075219482, 2.10187266675896, 2.076303134508863, 1.2908351800494753, 1.0654338975714148, 1.0709366378629679, 1.1274540610409725, 1.7166821707054205, 1.7619485100571872, 1.4115602773364324, 1.579893200699223, 1.0103927966820831, 1.524413131232837, 2.2522094642431445, 2.1496912178933356, 2.018616414982022, 2.1342231653345345, 1.7227944157336093, 0.5740375312625611, 1.4515608541235046, 1.0641986714807359, 1.9844207338302184, 1.378763696844776, 1.9814518390872056, 1.9858835817114067, 2.2019560433744156, 2.2601215654834155, 1.6734769481744527, 1.2068484176712115, 1.1812540228553088, 1.6674494685243175, 2.4339416802623735, 1.7402651573526111, 1.928715210399195, 1.6762748721998104, 0.8213311310832973, 1.7733585419181286, 2.325555379588773, 2.420738649181697, 1.7271204649201772, 1.435896468467237, 1.2035027985000566, 1.7747639197374738, 2.703074513610193, 1.6911887053175874, 1.9300230073702358, 1.5309122977446135, 1.772275481043207, 2.1161795539789368, 2.258822771738089, 2.943747382708567, 2.300046825592726, 2.4500332287732425, 2.2558464558483826, 0.9201312695507321, 2.1507225287830884, 1.6781643695379163, 2.532810339458583, 2.181057878157423, 2.1608949967429196, 2.754338204759319, 2.8893959289538445, 2.641288067768596, 1.8416644866856067, 1.200603675813338, 1.4767832609026028, 2.2361939778290014, 2.2748106318599213, 2.959683324412355, 2.269547924329367, 1.4394118156402385, 1.2701437987700979, 2.4699804051462686, 2.702806758958426, 2.7680990650737205, 1.9165776045648464, 1.521029460826021, 1.6827882626363233, 2.723488905700229, 2.7806486834258015, 2.6127599341877152, 1.9384370387122334, 1.9153720074401366, 2.2118607424248675, 2.7543262055883164, 3.407005453283853, 3.1209148100385797, 2.550244429263476, 2.624088295613512, 2.8680240985548773, 1.72116372224428, 2.4182650731273063, 2.892657865547064, 2.9271121689311608, 2.7969421790762308, 2.874361994856568, 3.249583257088905, 3.105073522574456, 2.4959198225634105, 2.190666541098684, 1.6977680038258085, 1.7950275274296945, 2.443761510536081, 2.743385625227032, 3.3393487546561422, 2.414880589257056, 1.9790950884952458, 1.3933681822364434, 3.2678198309344455, 3.715244687120016, 3.0565117940290594, 2.1910871670701475, 1.9638732646465118, 1.9751065467298143, 2.1901444038218005, 3.1226699989125324, 3.0754634874634625, 2.7503988559517225, 2.167514735043997, 2.3724299802390716, 3.406862789653113, 4.016949327058563, 3.7425880006480283, 3.5306347687006903, 3.2445727277246688, 3.7298246688957004, 1.5141695319943045, 2.0836031328146145, 2.926269546124151, 2.860698707831026, 3.2669068032772315, 3.1577104246922545, 2.0525976182747647, 2.2247832706107755, 2.7874998522492276, 1.7710206311815015, 0.8759448599741594, 0.8147583987619844, 1.9241236859533835, 1.665262062704695, 1.858437801079609, 2.085839395232398, 1.615498574347503, 0.9802123690044635, 2.248432022139001, 1.972326682916234, 1.7219429662754915, 1.3784390594721472, 1.5639342070987543, 1.3463805434800948, 2.399498394598707, 2.906458906301304, 1.8671979452461143, 1.7231060890004657, 1.3713159042464604, 1.7209538967017646, 1.893824008965808, 2.7047579116278153, 2.988213663457551, 2.3116928943780044, 1.6801576903613018, 1.9356268364500853, 1.309146389240974, 2.0781792515154325, 2.346671798904274, 2.665642350286251, 2.552866296203571, 2.3247938064256184};
